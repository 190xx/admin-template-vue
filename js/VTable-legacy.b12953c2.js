(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["VTable"],{"805f":function(e,t,n){"use strict";var a=n("c8f9"),r=n.n(a);r.a},c8f9:function(e,t,n){},e91f:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{position:"relative"}},[n("ATable",e._g(e._b({attrs:{"row-selection":e.rowSelection,"row-key":e.rowKey,pagination:e.pagination&&Object.assign({},e.pagination,{total:e.total},e.tableParams),columns:e.slotColumns,loading:e.loading,"data-source":e.tableData},on:{change:e.setTableParams},scopedSlots:e._u([e._l(e.slotColumns,function(t){return{key:t.scopedSlots.customRender,fn:function(a,r,s){return[e._t(t.scopedSlots.customRender,[n("span",{key:t.dataIndex+s,staticClass:"table-cell"},[e._v(e._s(a))])],null,{row:r,column:t,index:s,value:a})]}}})],null,!0)},"ATable",e.$attrs,!1),e.$listeners)),e.isXlsx&&"function"===typeof e.xlsx&&!e.loading?n("TableToXlsx",{attrs:{"is-selection":!!e.selection,loading:e.loading},on:{export:function(t){return e.exportXlsx(e.tableData)},"export-selected":function(t){return e.exportXlsx(e.selectedData)},"export-all":function(t){return e.exportAllXlsx()}}}):e._e()],1)},r=[],s=n("a34a"),i=n.n(s),o={props:{rowKey:{type:[Function,String],required:!0},notNumber:Boolean,isFixedNumber:{type:Boolean,default:!1},notAuto:Boolean,isPaging:Boolean,columns:{type:Array,required:!0,validator:function(e){return e.every(function(e){return void 0!==(e.key||e.dataIndex)})}},http:Function,dataSource:Array,isXlsx:Boolean,xlsx:Function,fileName:{type:String,default:"file"},params:Object,pagination:{type:[Object,Boolean],default:function(){return{position:"bottom",showSizeChanger:!0,showQuickJumper:!0,showTotal:function(e){return"共 ".concat(e," 条")}}}},current:{type:Number,default:1},pageSize:{type:Number,default:10},selection:{type:[Object,Boolean],default:!1},selectedKeys:Array,handler:{type:Function,default:function(e){return e}},isReload:Boolean},watch:{params:{handler:function(e,t){e&&!c(e,t)&&(this.tableParams.current=1,this.total=0,this.setTableList())},deep:!0},current:{handler:function(e){this.tableParams.current=Math.max(e,1)},immediate:!0},pageSize:{handler:function(e){this.tableParams.pageSize=Math.max(e,1)},immediate:!0},isReload:function(e){e&&this.setTableList()}}},c=function(e,t){var n=[JSON.stringify(e),JSON.stringify(t)],a=n[0],r=n[1];return a===r};function l(e,t,n,a,r,s,i){try{var o=e[s](i),c=o.value}catch(l){return void n(l)}o.done?t(c):Promise.resolve(c).then(a,r)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(a,r){var s=e.apply(t,n);function i(e){l(s,a,r,i,o,"next",e)}function o(e){l(s,a,r,i,o,"throw",e)}i(void 0)})}}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){d(e,t,n[t])})}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f={name:"VTable",components:{TableToXlsx:function(){return n.e("TableXlsx").then(n.bind(null,"8d67"))}},mixins:[o],data:function(){return{tableParams:{current:1,pageSize:10},total:0,selectedData:[],tableData:[],loading:!0}},computed:{slotColumns:function(){return p(this)},rowSelection:function(){return this.selection||this.selectedKeys?h({fixed:!0,selectedRowKeys:this.selectedKeys,onChange:this.onSelectChange,onSelect:this.hasSelectListener&&this.selectOneHandler,onSelectAll:this.hasSelectListener&&this.selectAllHandler},this.selection||{}):null}},beforeCreate:function(){this.hasSelectListener=!(!this.$options.propsData.selectedKeys||!this.$listeners.select),this.changeRows=[],this.selected=!1},created:function(){var e=this;this.notAuto||this.setTableList(),this.hasSelectListener&&this.$watch("selectedKeys",function(t){e.selectedData=e.selectedData.filter(function(n){return t.includes(m(n,e.rowKey))}),e.$emit("select",e.selectedData,e.changeRows,e.selected)})},methods:{setTableParams:function(e){var t=e.current,n=e.pageSize;this.tableParams={current:t,pageSize:n},this.$emit("change-params",{current:t,pageSize:n}),this.setTableList()},setTableList:function(){var e=u(i.a.mark(function e(){var t,n,a,r;return i.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.loading=!0,!this.isPaging&&!Array.isArray(this.dataSource)){e.next=12;break}if(this.total&&!this.isReload){e.next=9;break}return e.next=5,this.getData(this.params);case 5:t=e.sent,n=[t.total,t.data],this.total=n[0],this.tableData=n[1];case 9:this.$emit("change",b(this.tableData,this.tableParams)),e.next=19;break;case 12:return e.next=14,this.getData(h({},this.tableParams,this.params));case 14:a=e.sent,r=[a.total,a.data],this.total=r[0],this.tableData=r[1],this.$emit("change",this.tableData);case 19:this.isReload&&this.$emit("update:is-reload",!1),this.loading=!1;case 21:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),getData:function(){var e=u(i.a.mark(function e(t){var n,a;return i.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!Array.isArray(this.dataSource)){e.next=3;break}return n=this.handler(this.dataSource),e.abrupt("return",{data:n,total:n.length});case 3:return a={},e.prev=4,e.next=7,this.http(t);case 7:a=e.sent,a.data=this.handler(a.data),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](4),a={data:[],total:0};case 14:return e.abrupt("return",a);case 15:case"end":return e.stop()}},e,this,[[4,11]])}));function t(t){return e.apply(this,arguments)}return t}(),onSelectChange:function(e){this.$emit("update:selected-keys",e)},selectAllHandler:function(e,t,n){var a=this;n.forEach(function(t){return a.changeSelection(t,e)});var r=[n,e];this.changeRows=r[0],this.selected=r[1]},selectOneHandler:function(e,t){this.changeSelection(e,t);var n=[[e],t];this.changeRows=n[0],this.selected=n[1]},changeSelection:function(e,t){var n=this,a=m(e,this.rowKey),r=this.selectedData.findIndex(function(e){return m(e,n.rowKey)===a});t?r<0&&this.selectedData.push(e):r>-1&&(this.selectedData.splice(r,1),this.changeSelection(e,!1))},exportXlsx:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.fileName;this.xlsx({dataSource:e,columns:this.columns,fileName:t})},exportAllXlsx:function(){var e=u(i.a.mark(function e(){var t,n,a,r=arguments;return i.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:1,e.prev=1,n=[],a={current:t,pageSize:500},!this.isPaging&&!Array.isArray(this.dataSource)){e.next=8;break}n=b(this.tableData,a),e.next=12;break;case 8:if(!this.http){e.next=12;break}return e.next=11,this.getData(h({},a,this.params));case 11:n=e.sent.data;case 12:if(this.exportXlsx(n,this.fileName+t),!(n.length<500)){e.next=15;break}return e.abrupt("return");case 15:return e.next=17,this.exportAllXlsx(t+1);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e["catch"](1),this.$message.error("导出失败！");case 22:case"end":return e.stop()}},e,this,[[1,19]])}));function t(){return e.apply(this,arguments)}return t}()}},p=function(e){var t=e.columns,n=e.notNumber,a=e.isFixedNumber,r=e.tableParams,s=r.current,i=r.pageSize,o=t.map(function(e){return h({key:e.scopedSlots?e.key||e.dataIndex:x(e.key||e.dataIndex),fixed:a,dataIndex:e.dataIndex||e.key,scopedSlots:{customRender:e.dataIndex||e.key}},e)});return!n&&o.length&&"index"!==o[0].type&&o.unshift({type:"index",title:"序号",width:68,customRender:function(e,t,n){return(s-1)*i+n+1},scopedSlots:{customRender:"index"}}),o},b=function(e,t){var n=t.current,a=t.pageSize,r=(n-1)*a;return e.slice(r,r+a)},m=function(e,t){return"string"===typeof t?t.split(".").reduce(function(e,t){return e[t]},e):"function"===typeof t?t(e):e},x=function(e){return e},g=f,y=(n("805f"),n("2877")),v=Object(y["a"])(g,a,r,!1,null,"0c06602c",null);t["default"]=v.exports}}]);