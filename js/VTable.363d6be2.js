(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["VTable"],{1339:function(e,t,a){},9978:function(e,t,a){"use strict";var n=a("1339"),l=a.n(n);l.a},e91f:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{position:"relative"}},[a("ATable",e._g(e._b({attrs:{"row-selection":e.rowSelection,"row-key":e.rowKey,pagination:e.pagination&&Object.assign({},e.pagination,{total:e.total},e.tableParams),columns:e.slotColumns,loading:e.loading,"data-source":e.tableData},on:{change:e.setTableParams},scopedSlots:e._u([e._l(e.slotColumns,function(t){return{key:t.scopedSlots.customRender,fn:function(n,l,r){return[e._t(t.scopedSlots.customRender,[a("span",{key:t.dataIndex+r,staticClass:"table-cell"},[e._v(e._s(n))])],null,{row:l,column:t,index:r,value:n})]}}})],null,!0)},"ATable",e.$attrs,!1),e.$listeners)),e.isXlsx&&"function"===typeof e.xlsx&&!e.loading?a("TableToXlsx",{attrs:{"is-selection":!!e.selection,loading:e.loading},on:{export:function(t){return e.exportXlsx(e.tableData)},"export-selected":function(t){return e.exportXlsx(e.selectedData)},"export-all":function(t){return e.exportAllXlsx()}}}):e._e()],1)},l=[],r={props:{rowKey:{type:[Function,String],required:!0},notNumber:Boolean,isFixedNumber:{type:Boolean,default:!1},notAuto:Boolean,isPaging:Boolean,columns:{type:Array,required:!0,validator:e=>e.every(e=>void 0!==(e.key||e.dataIndex))},http:Function,dataSource:Array,isXlsx:Boolean,xlsx:Function,fileName:{type:String,default:"file"},params:Object,pagination:{type:[Object,Boolean],default:()=>({position:"bottom",showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条`})},current:{type:Number,default:1},pageSize:{type:Number,default:10},selection:{type:[Object,Boolean],default:!1},handler:{type:Function,default:e=>e},isReload:Boolean},watch:{params:{handler(e,t){e&&!o(e,t)&&(this.tableParams.current=1,this.total=0,this.setTableList())},deep:!0},current:{handler(e){this.tableParams.current=Math.max(e,1)},immediate:!0},pageSize:{handler(e){this.tableParams.pageSize=Math.max(e,1)},immediate:!0},isReload(e){e&&this.setTableList()}}};const o=function(e,t){const a=[JSON.stringify(e),JSON.stringify(t)],n=a[0],l=a[1];return n===l};function i(e,t,a,n,l,r,o){try{var i=e[r](o),s=i.value}catch(c){return void a(c)}i.done?t(s):Promise.resolve(s).then(n,l)}function s(e){return function(){var t=this,a=arguments;return new Promise(function(n,l){var r=e.apply(t,a);function o(e){i(r,n,l,o,s,"next",e)}function s(e){i(r,n,l,o,s,"throw",e)}o(void 0)})}}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){u(e,t,a[t])})}return e}function u(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var d={name:"VTable",components:{TableToXlsx:()=>a.e("TableXlsx").then(a.bind(null,"8d67"))},mixins:[r],data(){return{tableParams:{current:1,pageSize:10},total:0,selectedData:[],tableData:[],loading:!0}},computed:{slotColumns(){return h(this)},rowSelection(){if(!this.selection)return null;const e={fixed:!0,selectedRowKeys:this.selectAllKeys,onSelect:this.selectOneHandler,onSelectAll:this.selectAllHandler};return"object"===typeof this.selection?c({},e,this.selection):e},selectAllKeys(){return this.selectedData.map(e=>m(e,this.rowKey))}},created(){this.notAuto||this.setTableList()},methods:{setTableParams(e){let t=e.current,a=e.pageSize;this.tableParams={current:t,pageSize:a},this.$emit("change-params",{current:t,pageSize:a}),this.setTableList()},setTableList(){var e=this;return s(function*(){if(e.loading=!0,e.isPaging||Array.isArray(e.dataSource)){if(!e.total||e.isReload){const a=yield e.getData(e.params);var t=[a.total,a.data];e.total=t[0],e.tableData=t[1]}e.$emit("change",p(e.tableData,e.tableParams))}else{const t=yield e.getData(c({},e.tableParams,e.params));var a=[t.total,t.data];e.total=a[0],e.tableData=a[1],e.$emit("change",e.tableData)}e.isReload&&e.$emit("update:is-reload",!1),e.loading=!1})()},getData(e){var t=this;return s(function*(){if(Array.isArray(t.dataSource)){const e=t.handler(t.dataSource);return{data:e,total:e.length}}let a={};try{a=yield t.http(e),a.data=t.handler(a.data)}catch(n){a={data:[],total:0}}return a})()},selectAllHandler(e,t,a){a.forEach(t=>this.changeSelection(t,e)),this.$emit("select",this.selectedData,a,e)},selectOneHandler(e,t){this.changeSelection(e,t),this.$emit("select",this.selectedData,[e],t)},changeSelection(e,t){const a=m(e,this.rowKey),n=this.selectedData.findIndex(e=>m(e,this.rowKey)===a);t?n<0&&this.selectedData.push(e):n>-1&&(this.selectedData.splice(n,1),this.changeSelection(e,!1))},exportXlsx(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.fileName;this.xlsx({dataSource:e,columns:this.columns,fileName:t})},exportAllXlsx(){var e=this,t=arguments;return s(function*(){let a=t.length>0&&void 0!==t[0]?t[0]:1;try{let t=[];const l={current:a,pageSize:500};if(e.isPaging||Array.isArray(e.dataSource)?t=p(e.tableData,l):e.http&&(t=(yield e.getData(c({},l,e.params))).data),e.exportXlsx(t,e.fileName+a),t.length<500)return;yield e.exportAllXlsx(a+1)}catch(n){e.$message.error("导出失败！")}})()}}};const h=function(e){let t=e.columns,a=e.notNumber,n=e.isFixedNumber,l=e.tableParams,r=l.current,o=l.pageSize;const i=t.map(e=>c({key:e.scopedSlots?e.key||e.dataIndex:f(e.key||e.dataIndex),fixed:n,dataIndex:e.dataIndex||e.key,scopedSlots:{customRender:e.dataIndex||e.key}},e));return!a&&i.length&&"index"!==i[0].type&&i.unshift({type:"index",title:"序号",width:68,customRender:(e,t,a)=>(r-1)*o+a+1,scopedSlots:{customRender:"index"}}),i},p=function(e,t){let a=t.current,n=t.pageSize;const l=(a-1)*n;return e.slice(l,l+n)},m=function(e,t){return"string"===typeof t?t.split(".").reduce((e,t)=>e[t],e):"function"===typeof t?t(e):e},f=function(e){return e};var b=d,y=(a("9978"),a("2877")),g=Object(y["a"])(b,n,l,!1,null,"c6575b12",null);t["default"]=g.exports}}]);